<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional AVR Sizing Calculator | Kinmo PW</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Outfit:wght@700;800&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #F8FAFC;
            color: #1E293B;
        }

        .outfit {
            font-family: 'Outfit', sans-serif;
        }

        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }

        .hero-gradient {
            background: linear-gradient(135deg, #002B5B 0%, #004F9F 100%);
        }

        .result-gradient {
            background: linear-gradient(to bottom, #002B5B, #3B82F6);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .btn-navy {
            background: #002B5B;
            transition: all 0.3s ease;
        }

        .btn-navy:hover {
            background: #001A33;
            transform: translateY(-2px);
        }

        .btn-quote {
            background: #0084FF;
            transition: all 0.3s ease;
            box-shadow: 0 10px 15px -3px rgba(0, 132, 255, 0.4);
        }

        .btn-quote:hover {
            background: #0076e6;
            transform: translateY(-2px);
        }

        /* Styled Toggle Labels */
        .toggle-btn {
            transition: all 0.3s ease;
            font-weight: 700;
        }

        .active-toggle {
            background: #002B5B;
            color: white !important;
        }

        .inactive-toggle {
            color: #64748B;
            background: #F1F5F9;
        }

        /* Clean images */
        .product-img {
            mix-blend-mode: multiply;
        }
    </style>
</head>

<body class="min-h-screen pb-20">
    <div class="max-w-6xl mx-auto px-4 py-10">
        <!-- Header -->
        <header
            class="hero-gradient rounded-[1.5rem] sm:rounded-[2.5rem] p-6 sm:p-12 text-center text-white shadow-2xl mb-6 sm:mb-12">
            <div class="flex justify-center mb-4 sm:mb-6">
                <img src="logo.png" class="w-16 h-16 sm:w-24 sm:h-24 bg-white p-1 rounded-full shadow-lg">
            </div>
            <h1
                class="text-3xl sm:text-5xl font-black mb-2 outfit tracking-tight uppercase leading-tight sm:leading-none">
                Professional AVR Sizing Calculator</h1>
            <p class="text-base sm:text-xl opacity-90 font-bold mt-2 sm:mt-4">Kinmo PW Corporation | Power Quality
                Solutions</p>
        </header>

        <!-- Main Toggle -->
        <div class="flex justify-center mb-8 px-2">
            <div
                class="bg-white p-1 sm:p-2 rounded-2xl shadow-xl flex gap-1 sm:gap-2 border border-slate-200 w-full max-w-lg">
                <button id="mode-res" onclick="setMode('res')"
                    class="toggle-btn flex-1 px-2 sm:px-10 py-4 sm:py-5 rounded-xl text-sm sm:text-lg active-toggle">
                    <span class="sm:hidden">Res / Comm</span>
                    <span class="hidden sm:inline">Residential / Commercial</span>
                </button>
                <button id="mode-ind" onclick="setMode('ind')"
                    class="toggle-btn flex-1 px-2 sm:px-10 py-4 sm:py-5 rounded-xl text-sm sm:text-lg inactive-toggle">Industrial</button>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-10 items-start">
            <!-- Left Side: Inputs Card -->
            <div class="glass rounded-[2rem] p-6 sm:p-10 shadow-xl border border-slate-100 space-y-6 sm:space-y-8">
                <h2
                    class="text-3xl font-black text-slate-800 border-l-8 border-blue-600 pl-4 uppercase tracking-tighter">
                    Parameters</h2>

                <div>
                    <label class="block text-xs font-black text-slate-500 mb-3 uppercase tracking-[0.2em]"
                        id="label-app">Equipment Description</label>
                    <input type="text" id="app-name" placeholder="e.g., Central Aircon Unit"
                        class="w-full p-5 rounded-2xl border-2 border-slate-100 bg-slate-50 font-bold focus:border-blue-600 focus:bg-white outline-none">
                </div>

                <div>
                    <label class="block text-xs font-black text-slate-500 mb-3 uppercase tracking-[0.2em]">Load
                        Characteristic</label>
                    <select id="load-type"
                        class="w-full p-5 rounded-2xl border-2 border-slate-100 bg-slate-50 font-bold text-slate-700 cursor-pointer outline-none">
                        <option value="Resistive">Heating or Lighting (Resistive)</option>
                        <option value="Inductive">Motor or Compressor / Non-Inverter (Inductive)</option>
                        <option value="Inverter">Modern "Energy Saver" / Inverter (Inverter)</option>
                        <option value="Sensitive">IT & Server Gear / Computer (Sensitive)</option>
                        <option value="Hyper-Sensitive">High-Precision CNC/Medical (Hyper-Sensitive)</option>
                    </select>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-black text-slate-500 mb-3 uppercase tracking-[0.2em]">Input
                            Unit</label>
                        <div class="flex p-1 bg-slate-100 rounded-xl">
                            <label
                                class="flex-1 text-center py-3 rounded-lg cursor-pointer font-bold text-[10px] has-[:checked]:bg-white has-[:checked]:shadow-sm">
                                <input type="radio" name="meas" value="Power" checked onchange="updateUI()"
                                    class="hidden"> Power
                            </label>
                            <label
                                class="flex-1 text-center py-3 rounded-lg cursor-pointer font-bold text-[10px] has-[:checked]:bg-white has-[:checked]:shadow-sm">
                                <input type="radio" name="meas" value="kVA" onchange="updateUI()" class="hidden"> kVA
                            </label>
                            <label
                                class="flex-1 text-center py-3 rounded-lg cursor-pointer font-bold text-[10px] has-[:checked]:bg-white has-[:checked]:shadow-sm">
                                <input type="radio" name="meas" value="HP" onchange="updateUI()" class="hidden"> HP
                            </label>
                            <label
                                class="flex-1 text-center py-3 rounded-lg cursor-pointer font-bold text-[10px] has-[:checked]:bg-white has-[:checked]:shadow-sm">
                                <input type="radio" name="meas" value="Amps" onchange="updateUI()" class="hidden"> Amps
                            </label>
                        </div>
                    </div>
                    <div id="unit-scale-box">
                        <label
                            class="block text-xs font-black text-slate-500 mb-3 uppercase tracking-[0.2em]">Scale</label>
                        <div class="flex p-1 bg-slate-100 rounded-xl">
                            <label
                                class="flex-1 text-center py-3 rounded-lg cursor-pointer font-bold text-[11px] has-[:checked]:bg-white has-[:checked]:shadow-sm">
                                <input type="radio" name="unit" value="kW" checked class="hidden"> kW
                            </label>
                            <label
                                class="flex-1 text-center py-3 rounded-lg cursor-pointer font-bold text-[11px] has-[:checked]:bg-white has-[:checked]:shadow-sm">
                                <input type="radio" name="unit" value="Watts" class="hidden"> Watts
                            </label>
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-black text-slate-500 mb-3 uppercase tracking-[0.2em]">Value</label>
                    <input type="number" id="rating-val" value="0"
                        class="w-full p-5 rounded-2xl border-2 border-slate-100 bg-slate-50 font-black text-3xl outline-none">
                </div>

                <div>
                    <label class="block text-xs font-black text-slate-500 mb-3 uppercase tracking-[0.2em]">Connection
                        Type (3P Focus)</label>
                    <div class="flex p-1 bg-slate-100 rounded-xl">
                        <label
                            class="flex-1 text-center py-3 rounded-lg cursor-pointer font-bold text-[10px] has-[:checked]:bg-white has-[:checked]:shadow-sm">
                            <input type="radio" name="conn" value="LL" checked onchange="updateVoltageList()"
                                class="hidden"> Line-to-Line (Delta)
                        </label>
                        <label
                            class="flex-1 text-center py-3 rounded-lg cursor-pointer font-bold text-[10px] has-[:checked]:bg-white has-[:checked]:shadow-sm">
                            <input type="radio" name="conn" value="LN" onchange="updateVoltageList()" class="hidden">
                            Line-to-Neutral (Wye)
                        </label>
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-black text-slate-500 mb-3 uppercase tracking-[0.2em]">Voltage
                        Profile</label>
                    <select id="voltage-cfg"
                        class="w-full p-5 rounded-2xl border-2 border-slate-100 bg-slate-50 font-bold outline-none cursor-pointer">
                        <option value="1P-220V">Single Phase (1P) 220V</option>
                        <option value="1P-230V">Single Phase (1P) 230V</option>
                        <option value="3P-220V">Three Phase (3P) 220V</option>
                        <option value="3P-230V">Three Phase (3P) 230V</option>
                        <option value="3P-440V">Three Phase (3P) 440V</option>
                        <option value="3P-460V">Three Phase (3P) 460V</option>
                        <option value="3P-480V">Three Phase (3P) 480V</option>
                    </select>
                </div>

                <button onclick="calculate()"
                    class="btn-navy w-full py-6 text-white rounded-3xl font-black text-2xl uppercase tracking-widest shadow-xl">
                    Calculate Capacity</button>
            </div>

            <!-- Right Side: Output area (Hidden/Visible states) -->
            <div id="output-area" class="h-full flex flex-col">
                <!-- Result View -->
                <div id="result-view" class="hidden flex flex-col gap-8">
                    <!-- Specialized Error Box -->
                    <div id="err-box"
                        class="hidden p-8 bg-red-50 border-4 border-red-100 text-red-700 rounded-[2rem] font-bold shadow-lg leading-relaxed text-center">
                    </div>

                    <!-- Result Visualization -->
                    <div id="res-card"
                        class="bg-white rounded-[2rem] sm:rounded-[2.5rem] p-6 sm:p-10 text-center shadow-2xl border border-slate-100 flex-1 flex flex-col justify-between">
                        <div>
                            <span class="text-xs font-black text-slate-400 uppercase tracking-widest">Recommended
                                Capacity</span>
                            <div class="result-gradient text-6xl sm:text-8xl font-black outfit leading-none my-6 sm:my-8"
                                id="res-kva">0
                                <span class="text-2xl sm:text-3xl font-bold">kVA</span>
                            </div>

                            <div id="product-display"
                                class="mt-8 p-6 bg-slate-50 border-2 border-dashed border-slate-200 rounded-[2rem]">
                                <p
                                    class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 text-left">
                                    Recommended Unit Profile</p>
                                <div id="images-container" class="flex justify-center items-center gap-6 min-h-[150px]">
                                </div>
                            </div>
                        </div>

                        <div class="mt-8 space-y-4">
                            <!-- Technical Summary Box -->
                            <div class="p-5 bg-slate-50 border-2 border-slate-100 rounded-2xl text-left relative group">
                                <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-2">Technical
                                    Profile</p>
                                <div id="spec-summary"
                                    class="text-xs font-bold text-slate-700 leading-relaxed italic mb-4">
                                    --
                                </div>
                                <button onclick="copyToClipboard()" id="btn-copy-manual"
                                    class="w-full py-3 bg-white border border-slate-200 rounded-xl text-[10px] font-black uppercase tracking-widest text-slate-500 hover:bg-slate-50 transition-all flex items-center justify-center gap-2">
                                    <span id="copy-icon">üìã</span> <span id="copy-text">Copy Specs to Paste</span>
                                </button>
                            </div>

                            <a id="lnk-quote" href="#" target="_blank"
                                class="btn-quote flex items-center justify-center gap-3 w-full p-6 text-white rounded-[1.5rem] font-black text-2xl uppercase tracking-tighter transition-all">
                                <span>Inquire Now</span>
                                <span class="text-3xl">‚Üó</span>
                            </a>

                            <!-- Fallback Direct Page Link -->
                            <a href="https://www.facebook.com/kinmopwcorporation" target="_blank"
                                class="block w-full text-center py-3 text-[10px] font-black text-slate-400 uppercase tracking-widest hover:text-blue-600 transition-colors">
                                Having trouble? Visit our page directly
                            </a>

                            <div
                                class="p-6 bg-slate-50 rounded-2xl border border-slate-200 text-[11px] font-semibold text-slate-500 leading-relaxed italic text-left">
                                Official Note: This sizing is an engineering estimate based on standard load curves. To
                                finalize your specifications and ensure power quality accuracy, please schedule an
                                ocular inspection.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Empty State -->
                <div id="empty-state"
                    class="flex-1 flex flex-col items-center justify-center p-12 bg-slate-100/30 rounded-[2.5rem] border-4 border-dashed border-slate-100 text-center min-h-[400px]">
                    <div class="mb-10 relative">
                        <div class="absolute inset-0 bg-blue-600/5 blur-3xl rounded-full"></div>
                        <img src="logo.png" class="w-40 relative opacity-30 grayscale brightness-110">
                    </div>
                    <p class="text-slate-400 font-bold text-2xl leading-snug max-w-xs mx-auto">
                        Complete the parameters to generate your professional recommendation. Please send an inquiry for
                        more information.
                    </p>
                </div>

                <!-- Persistent Contact Card -->
                <div class="mt-8 bg-white p-6 sm:p-8 rounded-[2rem] shadow-sm border border-slate-200/50 text-left">
                    <p class="text-[10px] font-black text-blue-600 uppercase tracking-[0.3em] mb-6">Contact Our
                        Technical Team</p>
                    <div class="space-y-4">
                        <div class="space-y-2">
                            <a href="mailto:kinmovpsales@gmail.com"
                                class="flex items-center gap-3 text-sm font-bold text-slate-600 hover:text-blue-600 transition-colors">
                                <span class="text-blue-500 font-bold">‚úâ</span> kinmovpsales@gmail.com
                            </a>
                            <a href="mailto:e2shop.kinmo@gmail.com"
                                class="flex items-center gap-3 text-sm font-bold text-slate-600 hover:text-blue-600 transition-colors">
                                <span class="text-blue-500 font-bold">‚úâ</span> e2shop.kinmo@gmail.com
                            </a>
                        </div>
                        <div class="pt-4 border-t border-slate-100 space-y-3">
                            <div>
                                <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">üè¢ Office
                                </p>
                                <div class="flex flex-wrap gap-x-4 gap-y-1">
                                    <a href="tel:+639778407799"
                                        class="text-sm font-bold text-slate-600 hover:text-blue-600 transition-colors">0977
                                        840 7799</a>
                                    <a href="tel:+639167050208"
                                        class="text-sm font-bold text-slate-600 hover:text-blue-600 transition-colors">0916
                                        705 0208</a>
                                </div>
                            </div>
                            <div>
                                <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">‚ö° Sales
                                    Agents
                                </p>
                                <div class="flex flex-wrap gap-x-4 gap-y-1">
                                    <a href="tel:+639154815237"
                                        class="text-sm font-bold text-slate-600 hover:text-blue-600 transition-colors">0915
                                        481 5237</a>
                                    <a href="tel:+639924353306"
                                        class="text-sm font-bold text-slate-600 hover:text-blue-600 transition-colors">0992
                                        435 3306</a>
                                    <a href="tel:+639563483072"
                                        class="text-sm font-bold text-slate-600 hover:text-blue-600 transition-colors">0956
                                        348 3072</a>
                                    <a href="tel:+63908544560"
                                        class="text-sm font-bold text-slate-600 hover:text-blue-600 transition-colors">0908
                                        544 560</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="mt-12 text-center">
            <p class="text-slate-400 text-[10px] font-black uppercase tracking-[0.2em]">¬© 2024 Kinmo PW Corporation.
                Powering Excellence.</p>
        </footer>

        <script>
            let mode = 'res';

            function setMode(newMode) {
                mode = newMode;
                updateUI();
            }

            function updateUI() {
                const isRes = (mode === 'res');
                const baseClasses = "toggle-btn flex-1 px-2 sm:px-10 py-4 sm:py-5 rounded-xl text-sm sm:text-lg transition-all";
                document.getElementById('mode-res').className = isRes ? `${baseClasses} active-toggle shadow-lg` : `${baseClasses} inactive-toggle hover:bg-slate-200`;
                document.getElementById('mode-ind').className = !isRes ? `${baseClasses} active-toggle shadow-lg` : `${baseClasses} inactive-toggle hover:bg-slate-200`;

                const isPower = document.querySelector('input[name="meas"]:checked').value === 'Power';
                document.getElementById('unit-scale-box').style.opacity = isPower ? '1' : '0.3';
                document.getElementById('unit-scale-box').style.pointerEvents = isPower ? 'auto' : 'none';

                document.getElementById('label-app').innerText = isRes ? "Equipment Application" : "Industrial Machine / Load Type";
                document.getElementById('result-view').classList.add('hidden');
                document.getElementById('empty-state').classList.remove('hidden');
            }

            function calculate() {
                const rawValue = parseFloat(document.getElementById('rating-val').value) || 0;
                if (rawValue === 0) return;

                const inputType = document.querySelector('input[name="meas"]:checked').value;
                const loadKey = document.getElementById('load-type').value;
                const vKey = document.getElementById('voltage-cfg').value;

                const multipliers = { Resistive: 1.35, Inductive: 3.0, Inverter: 1.8, Sensitive: 1.6, 'Hyper-Sensitive': 2.0 };
                const voltages = {
                    '1P-220V': { phase: 1, v: 220, buffer: 1.3 },
                    '1P-230V': { phase: 1, v: 230, buffer: 1.3 },
                    '3P-220V': { phase: 3, v: 220, buffer: 1.4 },
                    '3P-230V': { phase: 3, v: 230, buffer: 1.4 },
                    '3P-380V': { phase: 3, v: 380, buffer: 1.35 },
                    '3P-400V': { phase: 3, v: 400, buffer: 1.35 },
                    '3P-415V': { phase: 3, v: 415, buffer: 1.35 },
                    '3P-440V': { phase: 3, v: 440, buffer: 1.3 },
                    '3P-460V': { phase: 3, v: 460, buffer: 1.3 },
                    '3P-480V': { phase: 3, v: 480, buffer: 1.3 }
                };

                const cfg = voltages[vKey];
                const pF = (cfg.phase === 3) ? 1.732 : 1.0;
                let baseKVA = 0;

                if (inputType === 'Power') {
                    const isWatts = document.querySelector('input[name="unit"]:checked').value === 'Watts';
                    const kw = isWatts ? rawValue / 1000 : rawValue;
                    baseKVA = kw / 0.8;
                } else if (inputType === 'kVA') {
                    baseKVA = rawValue;
                } else if (inputType === 'HP') {
                    baseKVA = (rawValue * 0.746) / 0.8;
                } else {
                    baseKVA = (rawValue * cfg.v * pF) / 1000;
                }

                // Calculation Logic: Multiplier vs. 30% Safety Cap
                let calcKVA = baseKVA * multipliers[loadKey];
                let floorKVA = baseKVA * cfg.buffer;
                let recKVA = Math.max(calcKVA, floorKVA);

                // UP Rounding Rule
                let finalKVA = 0;
                if (recKVA <= 15) {
                    finalKVA = Math.ceil(recKVA);
                } else if (recKVA <= 100) {
                    finalKVA = Math.ceil(recKVA / 10) * 10;
                } else if (recKVA <= 120) {
                    finalKVA = 120;
                } else if (recKVA <= 150) {
                    finalKVA = 150;
                } else if (recKVA <= 200) {
                    finalKVA = 200;
                } else {
                    finalKVA = Math.ceil(recKVA / 50) * 50;
                }

                // UI Control
                const resultArea = document.getElementById('result-view');
                const welcomeArea = document.getElementById('empty-state');
                const errorBox = document.getElementById('err-box');
                const resCard = document.getElementById('res-card');

                resultArea.classList.remove('hidden');
                welcomeArea.classList.add('hidden');

                // --- SCALE CHECKS ---

                // 1. Single Phase 60kVA Ceiling
                if (vKey === '1P-220V' && finalKVA > 60) {
                    errorBox.innerHTML = "<div class='text-2xl mb-2 uppercase tracking-tighter'>Load Capacity Warning</div>" +
                        "A requirement of <strong>" + finalKVA + "kVA</strong> is too big for Single Phase (1P 220V) hardware. " +
                        "Seek professional advice, request a quote or assistance from us below.";
                    errorBox.classList.remove('hidden');
                    resCard.classList.add('hidden');
                    return;
                }

                // 2. 3-Phase Minimum Check
                if (cfg.phase === 3 && finalKVA < 10) {
                    errorBox.innerHTML = "<div class='text-2xl mb-2 uppercase tracking-tighter'>3-Phase Threshold Error</div>" +
                        "Standard 3-Phase systems require a minimum 10kVA configuration. For smaller loads, please verify your equipment wiring or contact Kinmo Engineers.";
                    errorBox.classList.remove('hidden');
                    resCard.classList.add('hidden');
                    return;
                }

                errorBox.classList.add('hidden');
                resCard.classList.remove('hidden');

                document.getElementById('res-kva').innerHTML = finalKVA + ' <span class="text-3xl font-bold">kVA</span>';

                // Image Logic
                let html = '';
                let hyperSensitiveNote = '';

                if (loadKey === 'Hyper-Sensitive') {
                    hyperSensitiveNote = `
                    <div class="mt-6 p-5 bg-blue-50 border-2 border-blue-200 rounded-2xl text-left">
                        <div class="flex items-center gap-3 mb-2">
                            <span class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-600 text-white text-xs font-black">!</span>
                            <p class="text-[11px] font-black text-blue-900 uppercase tracking-widest">Precision Load Advisory</p>
                        </div>
                        <p class="text-[12px] font-bold text-blue-800 leading-relaxed">
                            For Hyper-Sensitive machines, we strongly recommend using an <strong>Active Voltage Conditioner</strong> or <strong>Static Voltage Regulator</strong> for nanosecond correction speeds. Please send an inquiry for more information.
                        </p>
                    </div>
                `;
                }

                if (finalKVA < 10) {
                    // Tier 1: Core 3
                    html = `<img src="avr1.png" class="h-28 product-img"><img src="avr2.png" class="h-28 product-img"><img src="avr3.png" class="h-28 product-img">`;
                } else if (finalKVA <= 60) {
                    // Tier 2: First Image (Vertical)
                    html = `<div class="text-center"><img src="avr_vertical.png" class="h-40 mx-auto product-img"><p class="text-[9px] font-black uppercase mt-3 text-slate-400 tracking-tighter">NSR Series Industrial Cabinet</p></div>`;
                } else if (finalKVA <= 500) {
                    // Tier 3: Second Image (Cabinet)
                    html = `<div class="text-center"><img src="avr_cabinet.png" class="h-40 mx-auto product-img"><p class="text-[9px] font-black uppercase mt-3 text-slate-400 tracking-tighter">High-Capacity Precision System</p></div>`;
                } else {
                    // Tier 4: Last Image (Huge)
                    html = `<div class="text-center"><img src="avr_huge.png" class="h-40 mx-auto product-img"><p class="text-[9px] font-black uppercase mt-3 text-slate-400 tracking-tighter">Utility Grade MVA Protection</p></div>`;
                }
                document.getElementById('images-container').innerHTML = html;

                // Append Hyper-Sensitive Note if applicable
                if (hyperSensitiveNote) {
                    document.getElementById('res-card').querySelector('div').insertAdjacentHTML('beforeend', hyperSensitiveNote);
                }

                const customerType = (mode === 'res') ? "Residential/Commercial" : "Industrial";
                const equipment = document.getElementById('app-name').value || "Equipment";
                const value = document.getElementById('rating-val').value;
                const inputUnit = (inputType === 'Power') ? document.querySelector('input[name="unit"]:checked').value : inputType;
                const connRef = document.querySelector('input[name="conn"]:checked').value === 'LL' ? 'L-L' : 'L-N';

                const messageText = `Hi Kinmo PW! I just used your Pro-Sizer tool to calculate my power needs. Here is the technical profile it generated for me:

CUSTOMER PROFILE: ${customerType}
EQUIPMENT: ${equipment}
INPUT DATA: ${value} ${inputUnit}
LOAD PROFILE: ${loadKey}
SYSTEM: ${cfg.phase}P ${cfg.v}V (${connRef} Ref)

APP RECOMMENDATION: ${finalKVA} kVA

I got these specs directly from using your app. Can you please confirm if you have this capacity in stock and provide a formal quote?

Thank you!`;

                const encoded = encodeURIComponent(messageText);

                // Show in summary box
                document.getElementById('spec-summary').innerText = `${finalKVA}kVA ${cfg.phase}P ${cfg.v}V for ${equipment}`;

                // Set the link using "Smart Link" logic
                const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                const lnk = document.getElementById('lnk-quote');

                if (isMobile) {
                    // Mobile can use either, but full URL is safer against blocks
                    lnk.href = "https://www.facebook.com/messages/t/kinmopwcorporation?text=" + encoded;
                } else {
                    // Full URL avoids SSL/security warnings on desktop browsers
                    lnk.href = "https://www.facebook.com/messages/t/kinmopwcorporation?text=" + encoded;
                }

                // Storage for manual copy button
                window.lastProfile = messageText;
                navigator.clipboard.writeText(messageText).then(() => console.log('Copied')).catch(() => { });
            }

            function copyToClipboard() {
                const text = window.lastProfile || "";
                if (!text) return;

                navigator.clipboard.writeText(text).then(() => {
                    const btn = document.getElementById('btn-copy-manual');
                    const textEl = document.getElementById('copy-text');
                    const iconEl = document.getElementById('copy-icon');

                    textEl.innerText = "Copied to Clipboard!";
                    iconEl.innerText = "‚úÖ";
                    btn.classList.add('border-green-300', 'text-green-600', 'bg-green-50');

                    setTimeout(() => {
                        textEl.innerText = "Copy Specs to Paste";
                        iconEl.innerText = "üìã";
                        btn.classList.remove('border-green-300', 'text-green-600', 'bg-green-50');
                    }, 3000);
                });
            }

            function updateVoltageList() {
                const conn = document.querySelector('input[name="conn"]:checked').value;
                const select = document.getElementById('voltage-cfg');
                const currentVal = select.value;
                select.innerHTML = '';

                // Unified 1P options (as requested "keep 1p as is")
                addOpt(select, '1P-220V', 'Single Phase (1P) 220V');
                addOpt(select, '1P-230V', 'Single Phase (1P) 230V');

                if (conn === 'LL') {
                    addOpt(select, '3P-220V', 'Three Phase (3P) 220V');
                    addOpt(select, '3P-230V', 'Three Phase (3P) 230V');
                    addOpt(select, '3P-440V', 'Three Phase (3P) 440V');
                    addOpt(select, '3P-460V', 'Three Phase (3P) 460V');
                    addOpt(select, '3P-480V', 'Three Phase (3P) 480V');
                } else {
                    addOpt(select, '3P-380V', 'Three Phase (3P) 380V (220V L-N)');
                    addOpt(select, '3P-400V', 'Three Phase (3P) 400V (230V L-N)');
                    addOpt(select, '3P-415V', 'Three Phase (3P) 415V (240V L-N)');
                }

                // Restore value if still in list
                if (Array.from(select.options).some(o => o.value === currentVal)) {
                    select.value = currentVal;
                }
            }

            function addOpt(sel, val, text) {
                const opt = document.createElement('option');
                opt.value = val;
                opt.innerText = text;
                sel.appendChild(opt);
            }

            updateUI();
            updateVoltageList();
        </script>
    </div>
</body>

</html>